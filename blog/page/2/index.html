
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Bitwise Evolution</title>
  <meta name="author" content="Rogan Creswick">

  
  <meta name="description" content="I&#8217;ve started using Maven to manage my java projects, and overall I&#8217;m very happy with it. It seems to be more mature than ivy, with better &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://creswick.github.com/blog/page/2/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Bitwise Evolution" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Bitwise Evolution</a></h1>
  
    <h2>Musings of a Portland-area hacker bent on improving digital lifestyles.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:creswick.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/05/23/bitten-by-dependency-management/">Bitten by Dependency Management</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-23T00:00:00-07:00" pubdate data-updated="true">May 23<span>rd</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://blog.ciscavate.org/wp-content/2009/05/dependencies.png"><img src="http://blog.ciscavate.org/wp-content/2009/05/dependencies-small.png" alt="dependencies-small" title="dependencies-small" width="145" height="200" class="alignright size-full wp-image-106" /></a>I&#8217;ve started using Maven to manage my java projects, and overall I&#8217;m very happy with it.  It seems to be more mature than ivy, with better documentation, and the vast majority of tasks that I need &#8220;just work&#8221; (just don&#8217;t ask me about jni&#8211;that&#8217;s another post).</p>

<p>Today, (and yesterday, and a good portion of the night in-between) I ran into a nasty bug in a library that I didn&#8217;t know my code depended on.  It isn&#8217;t particularly important <em>what</em> I was working on, but just for context: I needed to strip a lot of text content out of nodes in the complete wikipedia revision history dump, so I was using Sax to parse the xml stream, filter out the stuff I wanted filtered out, and save the stuff that, well, I wanted saved.  Being that the input was all of wikipedia, there were a fair number of unicode characters in there.  As it turns out, the 2.6.2 xercesImpl has some sort of bug that allows xml with certain characters to be read without throwing exceptions, but when you try to write the chars that were actually read, you end up trying to write characters that aren&#8217;t valid in xml.  Even if I&#8217;d known that in advance, my response would have been something like &#8220;ok, so what? I&#8217;m not using xercesImpl, and certainly not a version <em>that</em> old&#8221;.</p>

<p>Well.</p>

<p>You see, in addition to using Maven, I&#8217;ve also been using the <a href="http://code.google.com/p/google-collections/">Google Collections</a> and <a href="http://code.google.com/p/jsr-305/">JSR305</a> libraries, so I just drop those <code>&lt;dependency&gt;</code> entries into the pom for all my new projects&#8211;I just assume that I&#8217;ll need them, and I usually do.</p>

<p>Unfortunately, JSR305 1.3.8 depends on jaxen 1.1.1, which depends on xercesImpl 2.6.2 (jaxen also needs this dependency via xom 1.0, for what that&#8217;s worth).</p>

<p>Because that dependency was already present in my build path (via <code>mvn eclipse:eclipse</code>) and in the generated jar (via <code>&lt;addClasspath&gt;</code> and <code>&lt;classpathPrefix&gt;</code> in the <code>maven-jar-plugin</code>  configuration section), I never realized that my sax code actually had a <em>direct</em> dependency on xerces as well.  This all came to a head when, 3.53gb into my 2.8tb run, these rather unhelpful exceptions started popping up:</p>

<p>[cc lang=&#8221;bash&#8221;]
java.io.IOException: The character &#8216;?&#8217; is an invalid XML character</p>

<pre><code>   at org.apache.xml.serialize.BaseMarkupSerializer.characters(Unknown
</code></pre>

<p>Source)</p>

<pre><code>   at com.stottlerhenke.tools.wikiparse.ContentStripper.characters(ContentStripper.java:195)
   at org.apache.xerces.parsers.AbstractSAXParser.characters(Unknown
</code></pre>

<p>Source)</p>

<pre><code>   at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
</code></pre>

<p>Source)</p>

<pre><code>   at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
</code></pre>

<p>Source)</p>

<pre><code>   at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
   at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
   at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
   at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)
   at com.stottlerhenke.tools.wikiparse.ContentStripper.parse(ContentStripper.java:96)
   at com.stottlerhenke.tools.wikiparse.ContentStripper.main(ContentStripper.java:379)
</code></pre>

<p>[/cc]</p>

<p><code>&lt;rant&gt;</code> &#8220;?&#8221; is not unicode &#8211; it fits just fine in asci tables everywhere &#8211; so please don&#8217;t tell me that it&#8217;s an invalid unicode character :) (0xd800 <em>is</em> an invalid unicode character, and that would have been <em>much</em> more helpful) <code>&lt;/rant&gt;</code></p>

<p>Many hours later I was able to find a sample of the actual input that was causing these problems, and I was able to reproduce the issue with an input slightly smaller than 2.8tb.  Once that was done, I set out to make a minimal test case.  Rather than bother with a new maven project, I just hacked it out in emacs (not using google collections, etc. because, clearly, I wanted it minimal).  To my surprise, everything worked, and worked fantastically! But how? I didn&#8217;t even supply an xml api on the classpath, yet it ran just fine!</p>

<p>In truth, I <em>did</em> supply an xml api &#8211; xercesImpl.jar, and many other libraries &#8211; via my environment&#8217;s <code>$CLASSPATH</code>.  (Figuring that out was another adventure, but I digress.)  Once it became clear that I was indeed using a broken library it was simply a matter of explicitly specifying the dependency on a new version of xercesImpl, and rebuilding.</p>

<p>The moral?</p>

<p>Know your dependencies!  This should come along with knowing your language&#8217;s built-in APIs well.  It wasn&#8217;t clear to me that the SAX packages I was using were not part of the core java API, so it didn&#8217;t strike me as odd that I didn&#8217;t need to specify a classpath entry or a pom dependency before I could use sax.</p>

<p>If you suspect something strange, you can see the dependency tree in the generated html documentation you get when running <code>mvn site</code>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/05/14/fixing-the-key-repeat-in-ubuntu-904/">Fixing the Key Repeat in Ubuntu 9.04</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-14T00:00:00-07:00" pubdate data-updated="true">May 14<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I just upgraded my workstation to Jaunty (Ubuntu 9.04) and the key repeat delay and speed dropped to a frustrating level.</p>

<p>gnome-control-center can be used to fix this, but it requires that the gnome-settings-daemon be running, which forces it&#8217;s opinions on many other aspects of my environment (I run Enlightenment dr17).</p>

<p>Poking around a bit, and help from #e on freenode, revealed that <code>xset</code> can be used to fix the key repeat settings.</p>

<p>[cc lang=&#8221;bash&#8221;]</p>

<h1>Look at the current settings:</h1>

<p>$ xset q
Keyboard Control:
  auto repeat:  on    key click percent:  0    LED mask:  00000000
  auto repeat delay:  660    repeat rate:  25
  auto repeating keys:  00ffffffdffffbbf</p>

<pre><code>                    fadfffefffedffff
                    9fffffffffffffff
                    fff7ffffffffffff
</code></pre>

<h1>lets speed things up a bit&#8230;</h1>

<p>$ xset r rate 250 40
[/cc]</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/03/31/things-are-a-little-messy/">Things Are a Little Messy&#8230;</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-03-31T00:00:00-07:00" pubdate data-updated="true">Mar 31<span>st</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve had some minor upgrade issues with the blog lately, and I am only about halfway through updating everything.  In the meantime, I&#8217;m afraid things will look a bit messy.  (Syntax highlighting is currently broken, and there are probably other formatting / data issues as well.  I think I have to restore the uploads directory, for one, so there probably won&#8217;t be any images in the posts for a while.)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/02/04/like-food/">Like Food?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-02-04T00:00:00-08:00" pubdate data-updated="true">Feb 4<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://blog.ciscavate.org/wp-content/2009/02/imperial_stout.jpg"><img src="http://blog.ciscavate.org/wp-content/2009/02/imperial_stout-184x300.jpg" alt="" title="imperial_stout" height="100" class="alignright size-medium wp-image-89" /></a>
I started writing for another blog this week:</p>

<p><a href="http://bbcas.blogspot.com">Brewed, Bottled, Cultured and Sweetened</a> is a blog about beer, coffee, wine, cheese, chocolate, etc&#8230; that I&#8217;m writing with an old friend from <a href="http://codersbase.com">Dagit.o</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/01/26/the-linux-tablet-wacom-rotations-waking-up-on-the-wrong-side/">The Linux Tablet: Wacom Rotations - Waking Up on the Wrong Side</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-01-26T00:00:00-08:00" pubdate data-updated="true">Jan 26<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong>Update: updated the script with improved (functional) error output.  added notes about xhost.</strong></p>

<p>There is an annoying bug in the sequence of code that manages the wacom rotation / sleep / resume and stylus calibration right now. (Where &#8220;right now&#8221; is Ubuntu Intrepid, with the <a href="http://linuxwacom.sourceforge.net/">0.8.2-1 wacom drivers</a>.)</p>

<p>This is a document bug over at the <a href="https://bugs.launchpad.net/ubuntu/+source/wacom-tools/+bug/295292">ubuntu launchpad</a>, and the poster there does a fine job of describing the intricacies of reproducing the bug, so I&#8217;ll only give a brief explanation here to help get indexed.</p>

<p>If you rotate the screen any amount, even returning to the original rotation, and then sleep the machine, when it wakes up, the stylus will not be calibrated properly &#8211; the cursor will be off to the side of the stylus point.  It doesn&#8217;t seem to matter how it was calibrated when the machine slept, nor does it matter what rotation you&#8217;re in when you put the machine to sleep.</p>

<p>There is one straightforward workaround:  When you wake the machine, run wacomcpl, click on stylus, click calibrate (the mouse should now be under the stylus again), and exit wacomcpl.  This is incredibly cumbersome, but at least it&#8217;s better than restarting X, which is what I have been doing.</p>

<p>Further inspection (based largely on the thread of comments on that launchpad bug) reveals that the problem is actually related to bad values for the TopX, TopY, BottomX and BottomY settings on the wacom devices after a resume.  By resetting these to their proper values for the current rotation, we can reestablish the proper calibration.  First off, we need to know the proper values, and the easiest way to get them is with <code>xsetwacom</code>:</p>

<p>[cc lang=&#8221;bash&#8221;]</p>

<h1>!/bin/bash</h1>

<h1>wacomSettings</h1>

<p>echo &#8220;TopX=&#8221; <code>xsetwacom get stylus TopX</code>
echo &#8220;TopY=&#8221; <code>xsetwacom get stylus TopY</code>
echo &#8220;BottomX=&#8221; <code>xsetwacom get stylus BottomX</code>
echo &#8220;BottomY=&#8221; <code>xsetwacom get stylus BottomY</code>
[/cc]</p>

<p>Now, we&#8217;ll run this for each rotation, and save the results.  You should end up with something like the following:</p>

<p>[cc lang=&#8221;bash&#8221;]
 |rogue on bach |AC 70% | @ 00:02:26 ~|
 $ xrotate 1 &amp;&amp; wacomSettings
xrandr to left, xsetwacom to 2
TopX= -46
TopY= -3
BottomX= 18605
BottomY= 24518
 |rogue on bach |AC 70% | @ 00:02:28 ~|
 $ xrotate 2 &amp;&amp; wacomSettings
xrandr to inverted, xsetwacom to 3
TopX= 58
TopY= -46
BottomX= 24579
BottomY= 18605
 |rogue on bach |AC 70% | @ 00:02:35 ~|
 $ xrotate 3 &amp;&amp; wacomSettings
xrandr to right, xsetwacom to 1
TopX= -173
TopY= 58
BottomX= 18478
BottomY= 24579
 |rogue on bach |AC 70% | @ 00:02:41 ~|
 $ xrotate 0 &amp;&amp; wacomSettings
xrandr to normal, xsetwacom to 0
TopX= -3
TopY= -173
BottomX= 24518
BottomY= 18478
[/cc]</p>

<p>(Note that my bash prompt looks like &amp; command lines above are indented, and the output is left-aligned)</p>

<p>That gives us enough information to script the calibration when we resume.  For example, when resuming to a &#8220;normal&#8221; rotation, I need to run:</p>

<p>[cc lang=&#8221;bash&#8221;]
xsetwacom set stylus TopX -3
xsetwacom set stylus TopY -173
xsetwacom set stylus BottomX 24518
xsetwacom set stylus BottomY 18478
[/cc]
(Wrap that in a bash script and give it a shot!)</p>

<p>Here&#8217;s the full script that gets the current orientation and then calibrates the common wacom devices:</p>

<p>[cc lang=&#8221;bash&#8221;]</p>

<h1>!/bin/bash</h1>

<p>#</p>

<h1>waCalibrate.sh: recalibrates the wacom stylus</h1>

<p>#</p>

<h1>Author: Rogan Creswick</h1>

<h1>License: just be nice</h1>

<h1>Set LOG to something reasonable:</h1>

<h1>(The file does not need to exist, but the <em>directory</em> does)</h1>

<p>LOG=/home/rogue/calibration.out
XSETWACOM=/usr/local/bin/xsetwacom</p>

<p>#</p>

<h1>Calibrates the wacom devices {stylus, eraser, cursor} with the</h1>

<h1>given offsets:</h1>

<p>#</p>

<h1>Usage:</h1>

<h1>calibrate <topx> <topy> <bottomx> <bottomy></h1>

<p>#
function calibrate {</p>

<pre><code>${XSETWACOM} --display :0.0 set stylus TopX $1 &gt;&gt; ${LOG} 2&gt;&amp;1
${XSETWACOM} --display :0.0 set stylus TopY $2 &gt;&gt; ${LOG} 2&gt;&amp;1
${XSETWACOM} --display :0.0 set stylus BottomX $3 &gt;&gt; ${LOG} 2&gt;&amp;1
${XSETWACOM} --display :0.0 set stylus BottomY $4 &gt;&gt; ${LOG} 2&gt;&amp;1

${XSETWACOM} --display :0.0 set eraser TopX $1 &gt;&gt; ${LOG} 2&gt;&amp;1
${XSETWACOM} --display :0.0 set eraser TopY $2 &gt;&gt; ${LOG} 2&gt;&amp;1
${XSETWACOM} --display :0.0 set eraser BottomX $3 &gt;&gt; ${LOG} 2&gt;&amp;1
${XSETWACOM} --display :0.0 set eraser BottomY $4 &gt;&gt; ${LOG} 2&gt;&amp;1

${XSETWACOM} --display :0.0 set cursor TopX $1 &gt;&gt; ${LOG} 2&gt;&amp;1
${XSETWACOM} --display :0.0 set cursor TopY $2 &gt;&gt; ${LOG} 2&gt;&amp;1
${XSETWACOM} --display :0.0 set cursor BottomX $3 &gt;&gt; ${LOG} 2&gt;&amp;1
${XSETWACOM} --display :0.0 set cursor BottomY $4 &gt;&gt; ${LOG} 2&gt;&amp;1
</code></pre>

<p>}</p>

<p>function fixCalibration {</p>

<pre><code># get the current orientation:
ORIENTATION=`xrandr --verbose --query | grep " connected" | awk '{print $5}'`
echo "Orientation: ${ORIENTATION}" &gt;&gt; ${LOG}

case "${ORIENTATION}" in
normal)
    calibrate -3 -173 24518 18478   
    ;;
left)
    calibrate -46 -3 18605 24518
    ;;
right)
    calibrate -173 58 18478 24579
    ;;
inverted)
    calibrate 58 -46 24579 18605
    ;;
*)
    calibrate -3 -173 24518 18478
    echo "ERROR!! unknown orientation! ${ORIENTATION}" &gt;&gt; ${LOG}
    ;;
esac
</code></pre>

<p>}</p>

<p>case &#8220;$1&#8221; in</p>

<pre><code>resume|thaw)
date &gt;&gt; ${LOG}
fixCalibration 
whoami &gt;&gt; ${LOG} 
    ;;
*)
echo "not a resum|thaw event: $1" &gt;&gt; ${LOG}
    ;;
</code></pre>

<p>esac
[/cc]</p>

<p>Stick that in <code>/etc/pm/sleep.d/40wacomCalibrate</code> (or some similarly named file), make it executable by all (<code>chmod a+x /etc/pm/sleep.d/40wacomCalibrate</code>) and it should be run when the system resumes.</p>

<p><strong>Update:</strong> I found that the logging of the old script didn&#8217;t work, so I&#8217;ve updated the script to reflect that.  There were also some problems with how I was testing the first script, and the actions I was taking didn&#8217;t actually trigger the bug.  (The bug seems to be quite state-dependent, and markovian assumption was wrong.)  To get this to work, root will need to have access to the display that xsetwacom uses.  The simplest way to do this is to add <code>xhost +</code> to you x startup.  (I put it in my ~/.xsession just before <code>exec enlightenment-start</code>).
</bottomy></bottomx></topy></topx></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/01/12/the-linux-tablet-wacom-drivers/">The Linux Tablet: Wacom Drivers</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-01-12T00:00:00-08:00" pubdate data-updated="true">Jan 12<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Ubuntu 8.10 configured most everything properly, as mentioned in the <a href="http://blog.ciscavate.org/2009/01/the-path-to-a-linux-tablet.html">previous post</a> in this series, but it did not result in a functional pen.</p>

<p>The tablet screen is a wacom digitizer with a pen that has two buttons (eraser and a finger button), and the tablet can differentiate between touching and hovering.  The linux wacom driver &amp; tools are necessary to get this all working.  While I didn&#8217;t find a single page with instructions that worked flawlessly, I was able to figure it out from a collection of links:</p>

<ul>
<li> The Linux Wacom project:

<ul>
<li><a href="http://linuxwacom.sourceforge.net/index.php/minihowto">http://linuxwacom.sourceforge.net/index.php/minihowto</a></li>
<li><a href="http://linuxwacom.sourceforge.net/index.php/howto/x11">http://linuxwacom.sourceforge.net/index.php/howto/x11</a></li>
</ul>
</li>
<li> The Aliencam blog:

<ul>
<li><a href="http://blog.aliencam.net/articles/aliencams-customized-ubuntu-setup-guide/">http://blog.aliencam.net/articles/aliencams-customized-ubuntu-setup-guide/</a></li>
</ul>
</li>
</ul>


<p>First off, you will need the latest version of the linux Wacom driver (8.2.1 at the time of this writing).  The driver versions seem to be tied to your kernel versions, so this is quite important.  The wacom-tools package that comes with Ubuntu is not sufficient (in fact, you&#8217;ll want to uninstall it if you have it already).</p>

<p>Once you have the wacom package downloaded, follow the directions for installing it in the howto (linked above).  The wacom package uses a typical configure, make, make install process but there are a few kinks:</p>

<ul>
<li> configure (almost?) always succeeds, regardless of the dependencies you have yet to fill.  The make step will simply not build all the things you need if this happens, but it won&#8217;t fail visibly.</li>
<li> You&#8217;ll need to copy the kernel module into the /lib/modules/<code>uname -r</code>/kernel/drivers/usb/input/ directory manually (creating subdirs if necessary), <em>before</em> running make install.  (This is outlined in the mini-howto.)</li>
</ul>


<p>Once wacom is installed, you can begin working with the X.org configuration.  This is fairly clearly explained at the aliencam blog linked above, or you can use my xorg.conf here.</p>

<p>[cc lang=&#8221;bash&#8221;]
Section &#8220;Device&#8221;</p>

<pre><code>Identifier  "Configured Video Device"
</code></pre>

<p>EndSection</p>

<p>Section &#8220;Monitor&#8221;</p>

<pre><code>Identifier  "Configured Monitor"
</code></pre>

<p>EndSection</p>

<p>Section &#8220;Screen&#8221;</p>

<pre><code>Identifier  "Default Screen"
Monitor     "Configured Monitor"
Device      "Configured Video Device"
</code></pre>

<p>EndSection</p>

<h1>BEGIN TABLET SECTION</h1>

<p>Section &#8220;InputDevice&#8221;</p>

<pre><code>Driver      "wacom"
Identifier  "stylus"
Option      "Device"    "/dev/ttyS0"    # serial ONLY
Option      "Type"      "stylus"
Option      "ForceDevice"   "ISDV4"     # Tablet PC ONLY
Option      "Button2"   "3"
</code></pre>

<p>EndSection</p>

<p>Section &#8220;InputDevice&#8221;</p>

<pre><code>Driver      "wacom"
Identifier  "eraser"
Option      "Device"    "/dev/ttyS0"   # serial ONLY
Option      "Type"          "eraser"
Option      "ForceDevice"   "ISDV4"     # Tablet PC ONLY
Option      "Button3"   "2"
</code></pre>

<p>EndSection</p>

<p>Section &#8220;InputDevice&#8221;</p>

<pre><code>Driver        "wacom"
Identifier    "cursor"
Option        "Device"      "/dev/ttyS0"    # serial ONLY
Option        "Type"        "cursor"
Option        "ForceDevice" "ISDV4"     # Tablet PC ONLY
</code></pre>

<h1>Option        &#8220;Mode&#8221;            &#8220;Absolute&#8221;</h1>

<p>EndSection</p>

<h1>This section is for the TabletPC that supports touch</h1>

<h1>Section &#8220;InputDevice&#8221;</h1>

<h1>Driver        &#8220;wacom&#8221;</h1>

<h1>Identifier    &#8220;touch&#8221;</h1>

<h1>Option        &#8220;Device&#8221;        &#8220;/dev/input/wacom&#8221;  # USB ONLY</h1>

<h1>Option        &#8220;Type&#8221;          &#8220;touch&#8221;</h1>

<h1>Option        &#8220;ForceDevice&#8221;   &#8220;ISDV4&#8221;               # Tablet PC ONLY</h1>

<h1>Option        &#8220;USB&#8221;           &#8220;on&#8221;                  # USB ONLY</h1>

<h1>EndSection</h1>

<h1>END TABLET SECTION</h1>

<p>Section &#8220;ServerLayout&#8221;</p>

<pre><code>Identifier  "Default Layout"
Screen      "Default Screen"
</code></pre>

<h1>InputDevice &#8220;Synaptics Touchpad&#8221;</h1>

<h1>added to get tablet working</h1>

<pre><code>InputDevice     "stylus"    "SendCoreEvents"
InputDevice     "cursor"    "SendCoreEvents"
InputDevice     "eraser"    "SendCoreEvents"
</code></pre>

<h1>InputDevice &#8220;touch&#8221;     &#8220;SendCoreEvents&#8221;</h1>

<p>EndSection
[/cc]</p>

<p>After doing that, you should be able to reboot and the pen should be working.  You can do things like configure the buttons with <code>xsetwacom</code> (and you&#8217;ll need that when it comes time to rotate the screen), but I kept getting this error when I tried to run <code>xsetwacom</code>:</p>

<p>[cc lang=&#8221;bash&#8221;]
$ xsetwacom
xsetwacom: error while loading shared libraries: libwacomcfg.so.0: cannot open shared object file: no such file or directory.
[/cc]</p>

<p>I made a lucky guess, and fixed the problem with a quick ldconfig:</p>

<p>[cc lang=&#8221;bash&#8221;]
$ sudo ldconfig  # that was a lucky guess.
[/cc]</p>

<p><em>Update:</em> There were some issues with the wacom calibration after a sleep/resume cycle <em>if</em> the laptop screen had been rotated during that prior wake cycle (this happens a <em>lot</em> more than it seems, given how complex that description is.)  I&#8217;ve written up a workaround <a href="http://blog.ciscavate.org/2009/01/the-linux-tablet-wacom-rotations-waking-up-on-the-wrong-side.html">here</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/01/10/the-path-to-a-linux-tablet/">The Path to a Linux Tablet</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-01-10T00:00:00-08:00" pubdate data-updated="true">Jan 10<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I finally broke down and bought a Lenovo X61 tablet (with SXGA+ screen!), and it arrived this week.  This is the first of a series of posts about getting it up and running with Linux.</p>

<p>First off, some specs:</p>

<ul>
<li> Lenovo X61 Tablet PC with XSGA+ (1400x1050) screen (not multi-touch)</li>
<li> 4 gigs of ram</li>
<li> 200gb SATA hard disk</li>
<li> WIFI (Intel PRO/Wireless 4965 AG or AGN)</li>
<li> Gigabit Ethernet (Intel 82566MM)</li>
<li> Bluetooth</li>
<li> Wide-area networking card (3G)</li>
<li> Fingerprint reader</li>
<li> Integrated SD card reader (Richoh R5C822 SD/SDIO/MMC/MS/MSPro)</li>
<li> Intel Audio (82801H ICH8 Family audio controller)</li>
<li> 1 PCMCIA (type-I?) slot</li>
<li> 4-cell battery</li>
<li> Ultrabay Slim (which will be holding my Ultrabay CD-RW / DVD drive from my old T42p)</li>
<li> Intel Mobile GM965/GL960 video controller. (256mb video ram?)</li>
</ul>


<p>I&#8217;ll flesh that list out more as I can find the details (eg: wireless chipset, video, etc..)</p>

<p>First off, I blew some time poking around in Vista of course :).  The handwriting input app is phenomenal in a lot of ways.  It works very well, training is well integrated, and it has worked with every input area I&#8217;ve tried.  It <em>could</em> be better if it had contextual clues, and could tie into things like Eclipse&#8217;s intellisense.  Overall, though, it is amazing how simple it is to use, and how aesthetically pleasing the handwriting actually is.  There is a lot to be said for using a couple extra pixels to make the strokes taper off as you pull the pen away.  It has QWAN.</p>

<p>That done, I started to move on to installing Linux.  I&#8217;m giving Ubuntu 8.10 the first chance, and I thought I&#8217;d try using a USB-based install so I wouldn&#8217;t have to monkey around with the Ultrabase &amp; drive.  If you have an 8.10 system already, you can easily create a bootable usb ubuntu drive with <code>usb-creator</code> and an ubuntu iso.  This takes perhaps 45min - 1 hour.</p>

<p>Booting was as simple as going into the ibm bios-like page (by hitting the ThinkVantage button on boot) and telling it to boot from another device, then selecting the usb drive (that I had already inserted).  I split the existing 200gb partition in two with the ubuntu installer, keeping Vista in it&#8217;s 100 gig sandbox, and leaving the remaining ~100 gigs for Ubuntu to partition further (which it did, as two partitions: one for / and one for swap.  /dev/sda5 and /dev/sda6).</p>

<p>I do wish it had said how much space was being allocated to each of those partitions though.  The installer didn&#8217;t give any indication.</p>

<p>Installation from booting the installer from usb to booting into the installed system took right about 30min.  I&#8217;m impressed :)</p>

<p>Out of the box:</p>

<ul>
<li> The screen is the proper res</li>
<li> Wireless looks like it might be working (I have to AP to verify)</li>
<li> Sound works</li>
<li> the pen does <em>not</em></li>
<li> Screen rotation does not work</li>
<li> closing the lid shuts off the screen, but does not put the laptop to sleep.

<ul>
<li>This was easily fixed in the gnome power-management settings, and hey, it resumes too!</li>
</ul>
</li>
<li> putting the laptop in tablet mode seems to have no effect (at least it doesn&#8217;t shut off the screen ;)</li>
<li> Some power management is clearly working (screen dims when unplugged)</li>
<li> bluetooth was detected, but I have to way to test it.</li>
<li> Dual-booting seems to work just fine, although there are two entries for Vista in the grub menu, and the first boots into the Rescue and Recovery system.  Vista also had to do a chkdsk, and reboot before it would load.</li>
</ul>


<p>More information as I figure it out :)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/11/01/treat-your-mailing-lists-like-reference-documents-please/">Treat Your Mailing Lists Like Reference Documents, Please.</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-11-01T00:00:00-07:00" pubdate data-updated="true">Nov 1<span>st</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I desperately needed to find out why the tutorials I&#8217;ve been following for an Eclipse PDE task today kept referencing a startup.jar file that I could not locate.</p>

<p>A couple google searches later turned up this link:</p>

<p><a href="http://dev.eclipse.org/newslists/news.eclipse.platform/msg62159.html">http://dev.eclipse.org/newslists/news.eclipse.platform/msg62159.html</a></p>

<p>The poster in that thread had the same problem (back in Feb. 2007), and found the answer, but none of the content in that thread makes it trivial to locate the answer again.</p>

<p>The responder (with the answer) simply included a link to another mailing list:</p>

<p><a href="http://dev.eclipse.org/mhonarc/lists/cross-project-issues-dev/maillist.html">http://dev.eclipse.org/mhonarc/lists/cross-project-issues-dev/maillist.html</a></p>

<p>Notice that that page is <em>not</em> constant.  Today, it shows the most recent posts as of October 31st, 2008.  In order to figure out what had happened to startup.jar, I had to take into account the OP&#8217;s response (&#8220;Ok so this is <em>very</em> recent.&#8221;), the timestamp on the messages (Mon, 12 Feb 2007) and then navigate the mailing list archives to find that time period, and start reading.</p>

<p>Please don&#8217;t put people through this sort of crap.  It&#8217;s generally not difficult to find permlinks to a given email, or include a quick note with the actual answer.  I have the answer now (<a href="http://dev.eclipse.org/mhonarc/lists/cross-project-issues-dev/msg00873.html">startup.jar was replaced with org.eclipse.equinox.launcher in 3.3</a>), but there is no way that I can tie that answer to the conversation I&#8217;ve linked to above.</p>

<p>For the purposes of Google:</p>

<p>If you&#8217;re having this problem:</p>

<blockquote>
I&#8217;m trying to do some automation, but I&#8217;m running into a problem with the 3.3 integration build.<br /><br />

java -cp plugins\org.eclipse.platform_3.2.100.v20070126\startup.jar org.eclipse.core.launcher.Main<br /><br />

doesn&#8217;t do anything. It doesn&#8217;t say anything. The only information I&#8217;m getting is an exit status of 13. </blockquote>


<p>Then you need to use &#8220;java -jar plugins/org.eclipse.equinox.launcher_1.0.0.v20070207.jar&#8221; (adjusting the version numbers for your installation).</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/10/21/auto-documenting-osgi-commandproviders/">Auto-documenting OSGi CommandProviders</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-10-21T00:00:00-07:00" pubdate data-updated="true">Oct 21<span>st</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>(<strong>Edit:</strong> If you&#8217;re reading this after OSGi R4.2, then there is almost certainly a better way to accomplish the same thing)</p>

<p>I&#8217;ve been digging into OSGi a bit over the last week or so inorder to
create some Eclipse plugins that will automatically discover
eachother, and I&#8217;ve been generally impressed with the framework on the
whole.  The documentation is a bit lacking, but there are some good
blog posts about it.  (Specifically <a href="http://neilbartlett.name/blog/osgi-articles/&lt;u">Neil Bartlett&#8217;s introduction to
OSGi</a>.)</p>

<p>One thing that bugged me is the repetition needed when you implement
the CommandProvider interface to add commands to the OSGi console.
CommandProvider defines one method you must supply:</p>

<p>[cc lang=&#8221;java&#8221;]</p>

<pre><code>public String getHelp()
</code></pre>

<p>[/cc]</p>

<p>OSGi then uses reflection to extract each of the methods that starts
with an underscore, and supplies those methods to the command environment as
new commands.  (The underscore is trimmed, and the name of the method becomes
the command name.)  General practice is to include the name of the
method in the return value of <code>getHelp()</code>, along with a description of
what the method does, eg:</p>

<p>[cc lang=&#8221;java&#8221;]
public class SampleCommandProvider implements CommandProvider {</p>

<p>   public synchronized void _run(CommandInterpreter ci) {</p>

<pre><code>  // do stuff.
</code></pre>

<p>   }</p>

<p>   public String getHelp() {</p>

<pre><code>  return "\trun - execute a Runnable service";
</code></pre>

<p>   }
}[/cc]</p>

<p>This seems like a pain to maintain, so I took a quick look at
annotations, and propose a new syntax:</p>

<p>[cc lang=&#8221;java&#8221;]
public class SampleCommandProvider extends
   DescriptiveCommandProvider {</p>

<p>   @CmdDescr(description=&#8221;execute a Runnable service&#8221;)
   public synchronized void _run(CommandInterpreter ci) {</p>

<pre><code>  // do stuff.
</code></pre>

<p>   }
}[/cc]</p>

<p>Here we&#8217;ve extracted the <code>getHelp()</code> method into a new superclass, so
our SampleCommandProvider now extends an abstract class instead of
implementing an interface.  It also makes use of an Annotation, which
we need to define:</p>

<p>[cc lang=&#8221;java&#8221;]
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;</p>

<p>@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface CmdDescr {
   String description();
}[/cc]</p>

<p>Finally, we just need to define the superclass that implements
<code>getHelp()</code>:</p>

<p>[cc lang=&#8221;java&#8221;]
import java.lang.reflect.Method;
import java.util.regex.Matcher;
import java.util.regex.Pattern;</p>

<p>import org.eclipse.osgi.framework.console.CommandProvider;</p>

<p>public abstract class DescriptiveCommandProvider implements CommandProvider {</p>

<p>   private static final Pattern CMD_PATTERN = Pattern.compile(&#8221;<sup>_(.*)&#8221;);</sup>
   private String help = null;</p>

<p>   public String getHelp() {</p>

<pre><code>  if (null == help){
     help = buildHelp();
  }
  return help;
</code></pre>

<p>   }</p>

<p>   private String buildHelp() {</p>

<pre><code>  StringBuilder helpBuff = new StringBuilder();

  for (Method m : this.getClass().getMethods()){
     if (methodIsCmd(m)){         
        if (0 != helpBuff.length()){
           helpBuff.append("\n");
        }
        helpBuff.append(getDocumentation(m));            
     }
  }
  return helpBuff.toString();
</code></pre>

<p>   }</p>

<p>   private boolean methodIsCmd(Method m) {</p>

<pre><code>  return CMD_PATTERN.matcher(m.getName()).matches();
</code></pre>

<p>   }</p>

<p>   private String getDocumentation(Method m) {</p>

<pre><code>  StringBuilder methodHelp = new StringBuilder();

  Matcher matcher = CMD_PATTERN.matcher(m.getName());
  if(matcher.matches()){
     methodHelp.append("\t"+matcher.group(1));

     CmdDescr description = m.getAnnotation(CmdDescr.class);

     if (null != description){
        methodHelp.append(" - "+description.description());
     }
  }
  return methodHelp.toString();
</code></pre>

<p>   }
}
[/cc]</p>

<p>Note that the actual reflection on the class only happens once &#8211; all
subsequent calls to <code>getHelp()</code> use a cached copy of the documentation.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/09/23/its-called-a-docking-station-joel/">It&#8217;s Called a Docking Station, Joel :)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-09-23T00:00:00-07:00" pubdate data-updated="true">Sep 23<span>rd</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The venerable Joel Spolsky asked recently why <a href="http://www.joelonsoftware.com/items/2008/09/20.html">someone hasn&#8217;t made a device</a> that clips to the back of a desk and:</p>

<blockquote>
    * It&#8217;s a power strip<br>
    * It&#8217;s a network hub<br>
    * It&#8217;s a USB hub<br>
    * You clamp it onto the back of any desk
</blockquote>


<p>The idea being that:</p>

<blockquote>This would make it easy to plug in laptops, USB peripherals, and all your rechargers at your desk without crawling around on the floor.</blockquote>


<p>He links to a device that does some of this, and runs ~$150/device.  At that price, I think a better solution is a docking station&#8211;when you get down to it, I don&#8217;t want to plug in 4 things every time I sit down even if it doesn&#8217;t involve crawling under the desk (power, video, usb, ethernet and possibly audio).  I think it&#8217;s unlikely that all the features needed above are really necessary when you just show up for a meeting, or hop over to your coworker&#8217;s office for a short hacking session.  Many conference rooms these days already have tables wired for ethernet / power and svga video to a projector.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/3/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2011/11/07/xmonad-in-fedora-15/">Installing custom XSessions in Fedora 15</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/10/31/blogging-with-octopress/">Blogging with Octopress</a>
      </li>
    
      <li class="post">
        <a href="/blog/2010/12/24/hacking-your-kitchen-making-a-sous-vide/">Hacking your kitchen: making a sous vide</a>
      </li>
    
      <li class="post">
        <a href="/blog/2010/12/22/cabal-dev-sandboxing-your-haskell-development-and-now-with-ghci/">cabal-dev: sandboxing your Haskell development (and now with ghci!)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2010/10/06/prezi-scalable-navigable-presentations/">Prezi: scalable, navigable presentations</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/creswick">@creswick</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'creswick',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("autoorator", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/autoorator" class="twitter-follow-button" data-show-count="false">Follow @autoorator</a>
  
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/creswick?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Rogan Creswick -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
